<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tetris</title>
<style>
body{
  margin:0;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  background:#000;
}
canvas{
  background:#111;
}
</style>
</head>
<body>

<canvas id="c" width="300" height="600"></canvas>

<script>
const c=document.getElementById("c");
const x=c.getContext("2d");

const COL=10,ROW=20,S=30;
let board=Array.from({length:ROW},()=>Array(COL).fill(0));
let p={x:4,y:0,s:[[1,1,1,1]]};

function draw(){
  x.clearRect(0,0,300,600);
  board.forEach((r,y)=>r.forEach((v,x0)=>{
    if(v){x.fillStyle="#0ff";x.fillRect(x0*S,y*S,S-1,S-1);}
  }));
  p.s.forEach((r,y)=>r.forEach((v,x0)=>{
    if(v){x.fillRect((p.x+x0)*S,(p.y+y)*S,S-1,S-1);}
  }));
}

function collide(){
  return p.s.some((r,y)=>r.some((v,x0)=>{
    if(!v)return false;
    let nx=p.x+x0,ny=p.y+y;
    return nx<0||nx>=COL||ny>=ROW||board[ny]?.[nx];
  }));
}

function tick(){
  p.y++;
  if(collide()){
    p.y--;
    p.s.forEach((r,y)=>r.forEach((v,x0)=>{
      if(v)board[p.y+y][p.x+x0]=1;
    }));
    p={x:4,y:0,s:[[1,1,1,1]]};
    if(collide()) alert("Game Over");
  }
  draw();
}

setInterval(tick,500);

document.onkeydown=e=>{
  if(e.key==="ArrowLeft")p.x--;
  if(e.key==="ArrowRight")p.x++;
  if(e.key==="ArrowDown")p.y++;
  if(collide()){
    if(e.key==="ArrowLeft")p.x++;
    if(e.key==="ArrowRight")p.x--;
    if(e.key==="ArrowDown")p.y--;
  }
  draw();
}
</script>

</body>
</html>
